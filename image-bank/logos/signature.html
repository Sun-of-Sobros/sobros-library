<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CHROMA Email Signature</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet"> <!-- Glitchy Font -->
  <style>
    body {
      margin: 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 400px; /* Set height of email signature */
      font-family: 'Consolas', sans-serif; /* Glitchy Font */
      overflow: hidden;
    }
    .left-column {
      flex: 1;
      padding: 20px;
      color: white; /* Initial color for text */
    }
    .contact-info {
      margin-top: 10px;
    }
    .right-column {
      flex: 1;
      position: relative;
      height: 100%; /* Set height to fill parent */
    }
    .logo {
      position: absolute;
      top: 50%;
      right: 20px;
      transform: translateY(-50%);
      max-height: 300px;
      opacity: 0; /* Initially hidden */
      animation: revealLogo 5s infinite; /* Animation to reveal logo */
    }

    /* Animation to reveal logo */
    @keyframes revealLogo {
      0%, 100% {
        opacity: 0;
      }
      50% {
        opacity: 1;
      }
    }
  </style>
</head>
<body>
  <div class="left-column">
    <h2>BRENT DAKIS</h2>
    <p>Creative Director</p>
    <div class="contact-info">
      <p>0481 136 334</p>
      <p>colourme@chroma.institute</p>
    </div>
  </div>
  <div class="right-column" style="background-color: transparent;"> <!-- Transparent background -->
    <img src="" class="logo" alt="CHROMA Logo">
    <canvas id="canvas"></canvas>
  </div>

  <script>
      const canvas = document.getElementById("canvas");
      const ctx = canvas.getContext("2d");
      const pixelPercentage = 10; // Adjust this value as needed
      const pixelSize = Math.ceil((Math.min(window.innerWidth, window.innerHeight) * pixelPercentage) / 100);
      const gridWidth = Math.ceil(800 / pixelSize); // Limit table width to 800px
      const gridHeight = Math.ceil(400 / pixelSize); // Limit table height to 400px
      const colours = ["#410a53", "#DB3A34", "#BA2C73", "#FF1053", "#FF006E", "#3A86FF", "#FB5607", "#59CD90", "#EAE151", "#2E0219", "#E6AF2E"];
      const mainColour = colours[Math.floor(Math.random() * colours.length)];

      document.querySelector('.logo').src = getRandomLogo();
      adjustLinkColors(mainColour);

      canvas.width = 800; // Set canvas width to 800px
      canvas.height = 400; // Set canvas height to 400px
      const pixels = Array.from({ length: gridWidth * gridHeight }, (_, i) => ({
          x: (i % gridWidth) * pixelSize,
          y: Math.floor(i / gridWidth) * pixelSize,
          colour: getRandomColour(),
          locked: false
      }));

      function getRandomLogo() {
          const logos = Array.from({length: 25}, (_, i) => `Chroma-brand_mosh-${i + 1}.gif`);
          return `https://sun-of-sobros.github.io/sobros-library/image-bank/logos/mosh/${logos[Math.floor(Math.random() * logos.length)]}`;
      }

      function getRandomColour() {
          return colours[Math.floor(Math.random() * colours.length)];
      }

      function updateCanvas() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          pixels.forEach(p => {
              ctx.fillStyle = p.locked ? 'rgba(0, 0, 0, 0)' : p.colour;
              ctx.fillRect(p.x, p.y, pixelSize, pixelSize);
          });
      }
      function adjustLinkColors(bgColor) {
          const color = bgColor.charAt(0) === '#' ? bgColor.substring(1, 7) : bgColor;
          const r = parseInt(color.substring(0, 2), 16);
          const g = parseInt(color.substring(2, 4), 16);
          const b = parseInt(color.substring(4, 6), 16);
          const brightness = (r * 299 + g * 587 + b * 114) / 1000;
          const textColor = brightness > 125 ? 'black' : 'white';
          document.querySelectorAll('.left-column *').forEach(element => {
              element.style.color = textColor;
          });
      }

      animate(); // Start the random animation immediately

      window.addEventListener('resize', () => {
          canvas.width = 800; // Set canvas width to 800px
          canvas.height = 400; // Set canvas height to 400px
          updateCanvas();
      });
  </script>

</body>
</html>
